name: Continuouss Architecture

environments:
  prod:
    test-project-1:
      vault: some-vault-identifier
  stage:
    test-project-1:
      file: .env.stage
    test-project-2:
      file: .env.stage

providers:
  aws:
    config:
      accountId: AWS_ACCOUNT_ID
      accessKeyId: AWS_ACCESS_KEY_ID
      secretAccessKey: AWS_SECRET_ACCESS_KEY
      region: AWS_DEFAULT_REGION
  heroku:
    config:
      username: HEROKU_USER
      password: HEROKU_PASSWORD

projects:
  api-server:
    path: $PROJECT_ROOT/tests/test-project-1
    modulePath: src/modules
    interfaces:
    - name: files
    - name: messaging
    - name: database
    - name: rpc
  customer-mobile-app:
    path: $PROJECT_ROOT/tests/test-project-2
    modulePath: src/lib
    interfaces:
    - name: rpc
  admin-web-app:
    path: $PROJECT_ROOT/tests/test-project-2
    modulePath: src/lib
    interfaces:
    - name: rpc

interfaces:
  files:
    name: 'File bucket'
    apis:
    - name: system-file-api
    - name: user-file-api

  messaging:
    name: 'PubSub'
    apis:
    - name: default

  database:
    name: 'Database'
    apis:
    - name: database
      path: specs/mysql.yml
    links:
      projects:
      - test-project-1
      services:
      - mysql

  rpc:
    name: 'API'
    apis:
    - name: rpc
      path: specs/api.yml

services:
  http:
    ssl: true
  mysql:
    provision: true
    connection:
      host: MYSQL_HOST
      port: MYSQL_PORT
      user: MYSQL_USER
      password: MYSQL_PASSWORD
